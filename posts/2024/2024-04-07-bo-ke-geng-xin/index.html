<!doctype html><html lang=zh><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><title>博客更新</title><meta content=博客更新 name=title><meta content=一点点从这个世界上消失。 name=description><meta content=website property=og:type><meta content=https://nnnewb.github.io/posts/2024/2024-04-07-bo-ke-geng-xin/ property=og:url><meta content="weakptr's blog" property=og:site_name><meta content=博客更新 property=og:title><meta content=一点点从这个世界上消失。 property=og:description><meta content=https://nnnewb.github.io/image/favicon.ico property=og:image><meta content=summary_large_image property=twitter:card><meta content=https://nnnewb.github.io/posts/2024/2024-04-07-bo-ke-geng-xin/ property=twitter:url><meta content=博客更新 property=twitter:title><meta content=一点点从这个世界上消失。 property=twitter:description><meta content=https://nnnewb.github.io/image/favicon.ico property=twitter:image><link href=https://nnnewb.github.io/posts/2024/2024-04-07-bo-ke-geng-xin/ rel=canonical><link rel="shortcut icon" href=https://nnnewb.github.io/image/favicon.ico type=image/x-icon><link href=https://nnnewb.github.io/css/reset.css rel=stylesheet><link href=https://nnnewb.github.io/css/pallete.css rel=stylesheet><link href=https://nnnewb.github.io/css/suCSS.css rel=stylesheet><link href=https://nnnewb.github.io/archive.css rel=stylesheet><link href=https://nnnewb.github.io/style.css rel=stylesheet><script defer src=https://nnnewb.github.io/js/script.js></script><link crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css integrity=sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y rel=stylesheet><script crossorigin defer integrity=sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx src=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js></script><script crossorigin defer integrity=sha384-zWYbd0NBwgTsgIdFKVprSfTh1mbMPe5Hz1X3yY4Sd1h/K1cQoUe36OGwAGz/PcDy src=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/mathtex-script-type.min.js></script><script crossorigin defer integrity=sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe src=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js></script><script>document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
            // customised options
            // • auto-render specific keys, e.g.:
            delimiters: [
                { left: '$$', right: '$$', display: true },
                { left: '$', right: '$', display: false },
                { left: '\\(', right: '\\)', display: false },
                { left: '\\[', right: '\\]', display: false }
            ],
            // • rendering keys, e.g.:
            throwOnError: true
        });
    });</script><script src=https://cdn.jsdelivr.net/npm/mermaid@11.6.0/dist/mermaid.min.js></script><script>document.addEventListener('DOMContentLoaded', function () {
        // 查找所有具有 'pre' 标签且类名为 'language-mermaid' 的元素
        const mermaidElements = document.getElementsByClassName('language-mermaid');
        for (let i = 0; i < mermaidElements.length; i++) {
            const el = mermaidElements.item(i);
            if (el.tagName === "PRE" && !el.classList.contains('mermaid')) {
                el.innerHTML = el.textContent;
                el.classList.add('mermaid');
            }
        }

        mermaid.initialize({ startOnLoad: true, theme: 'dark', });
    })</script><script>if (window.location.hostname.toLowerCase() !== 'localhost' && window.location.hostname !== '127.0.0.1') {
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?dbb9df33a2de52aede8bccd84a7493ad";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    }</script><link href=https://chinese-fonts-cdn.deno.dev/packages/lxgwwenkaibright/dist/LXGWBright-Medium/result.css rel=stylesheet><link href=https://chinese-fonts-cdn.deno.dev/packages/maple-mono-cn/dist/MapleMono-CN-Regular/result.css rel=stylesheet><body><header><nav id=nav-bar><a href=/> 首页 </a>  /  <a href=/posts/> 文章 </a>  /  <a href=/categories/> 分类 </a>  /  <a href=/tags/> 标签 </a>  /  <a href=/search/> 搜索 </a>  /  <div><input id=theme-toggle style=display:none type=checkbox><label for=theme-toggle id=theme-toggle-label><svg class=icons id=theme-icon><use href=https://nnnewb.github.io/icons.svg#lightMode></use></svg></label><audio id=theme-sound><source src=https://nnnewb.github.io/click.ogg type=audio/ogg></audio></div></nav></header><main><h1>博客更新</h1><p class=author-line>作于：2024-04-07 18:42 ，预计阅读时间 4 分钟<article><p>15分钟，大概介绍下新的博客引擎和主题。<p>博客换了新引擎 zola (<a href=https://github.com/getzola/zola/>getzola/zola</a>)，主要看中构建速度非常快，对比无缓存的 hugo 能达到几十倍的速度。<p>新主题是 anemone ，但是原主题太粗糙了我自己进行了很多魔改。<ul><li>加入 categories 这个 taxonomy 模板<li>加入 katex 支持<li>加入 mermaid 支持<li>加入 giscus 支持<li>加入自定义 footer 文本<li>调整 header 导航条<li>调整 tags 页的样式，tag 的字体大小和文章数关联<li>一些 bug 修复</ul><p>原来的 hugo 文章 frontmatter 里有很多字段和 zola 是不匹配的，特别是 categories/tags/date/lastmod 这几个我用到了的。<p>处理方法是写了一个 python 脚本，读取 frontmatter 内容并解析，然后调整成 zola 的格式。<p>说道为什么突然开始看构建性能了，其实一直是有关注的，特别是我把博客构建迁移到自己的 vps 上之后，使用 drone ci 进行自动构建和发布。<p>在调试 drone ci 的时候就注意到了 hugo 的 cpu 和内存使用特别高，但我本机跑就快的一批，但一直没时间去优化。呃，也不是没时间，就是懒得动。<p>这两天忽然想起来博客构建慢的一批，于是就考虑迁移 drone 到家里闲置的树莓派上，树莓派不能白用电不干活对吧。<p>结果迁移上去后发现，hugo 构建依然要分配至少 3 个核心，才能在 4 分钟构建完不超时，比在腾讯云的 2C2G 轻量应用服务器上的表现还垃圾。<p>我这才想起来去查了一下树莓派 4b 的性能，对比居然被 intel 赛扬 j4125 这颗工控机上常见的低端 u 吊打了，n100 干脆能达到树莓派 4b 的 4 倍性能...<p>哭了。<p>擦擦眼泪继续折腾。<p>试了下在 r7 5700x + 固态盘上构建，无缓存差不多要 20 多秒，基本达到不可接受的程度，我文章都才 100 多篇，这点内容就要 20 多秒了我没法接受。于是又捡起了以前玩过一次的 zola ，在 5700x 平台测试是 build 要 800ms 不到，树莓派 4b 平台是 7s 的 build 时间。<p>考虑到自己建的 gitea 服务器一是没什么内容，二是受限于服务器的下行带宽，开始 clone 的时候基本就访问网页都困难了。于是又把 drone 切换到 gitee 环境，clone 时间从 2 分钟降低到 15s 内。<p>至此基本就达到预期了，个人体验是非常满意，但老文章有些细节，主要是 katex 公式渲染是有问题的，需要之后处理。<p>还有个坑是 zola build 的时候会显示未知的语法 mermaid，这个不影响 mermaid.js 渲染。</article><p class=tags-data><a href=/tags/bo-ke>/博客/</a></p><script data-repo-id="MDEwOlJlcG9zaXRvcnkzOTg0ODYyMTg=" async crossorigin data-category=Announcements data-category-id=DIC_kwDOF8Bqys4Cegmn data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-mapping=pathname data-reactions-enabled=1 data-repo=nnnewb/nnnewb.github.io data-strict=0 data-theme=noborder_light id=giscus_script src=https://giscus.app/client.js></script></main><footer><hr><div id=footer-container><div><p style=text-align:center>Copyright © 2018-2024 weakptr <a href=mailto:weak_ptr@outlook.com>&lt;weak_ptr@outlook.com></a><p style=text-align:center>Built with <a rel="noopener noreferrer" href=https://www.getzola.org target=_blank>Zola</a> using <a rel="noopener noreferrer" href=https://github.com/Speyll/anemone target=_blank>anemone</a> theme, <a rel="noopener noreferrer" href=https://speyll.github.io/suCSS/ target=_blank>suCSS</a> framework & <a rel="noopener noreferrer" href=https://github.com/Speyll/veqev target=_blank>veqev</a>, modified by <a rel="noopener noreferrer" href=https://github.com/nnnewb/ target=_blank>nnnewb</a>.<p style=text-align:center>Theme and color theme licensed under <a rel="noopener noreferrer" href=https://en.wikipedia.org/wiki/Licence_MIT target=_blank>MIT</a>.</div></div></footer>