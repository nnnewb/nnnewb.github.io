<!doctype html><html lang=zh><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><title>Windows 11 24H2 关闭 Hyper-V 和基于虚拟化的安全特性</title><meta content="Windows 11 24H2 关闭 Hyper-V 和基于虚拟化的安全特性" name=title><meta content=一点点从这个世界上消失。 name=description><meta content=website property=og:type><meta content=https://nnnewb.github.io/posts/2025/2025-01-15-windows11-24h2guan-bi-hyperv/ property=og:url><meta content="weakptr's blog" property=og:site_name><meta content="Windows 11 24H2 关闭 Hyper-V 和基于虚拟化的安全特性" property=og:title><meta content=一点点从这个世界上消失。 property=og:description><meta content=https://nnnewb.github.io/image/favicon.ico property=og:image><meta content=summary_large_image property=twitter:card><meta content=https://nnnewb.github.io/posts/2025/2025-01-15-windows11-24h2guan-bi-hyperv/ property=twitter:url><meta content="Windows 11 24H2 关闭 Hyper-V 和基于虚拟化的安全特性" property=twitter:title><meta content=一点点从这个世界上消失。 property=twitter:description><meta content=https://nnnewb.github.io/image/favicon.ico property=twitter:image><link href=https://nnnewb.github.io/posts/2025/2025-01-15-windows11-24h2guan-bi-hyperv/ rel=canonical><link rel="shortcut icon" href=https://nnnewb.github.io/image/favicon.ico type=image/x-icon><link href=https://nnnewb.github.io/css/reset.css rel=stylesheet><link href=https://nnnewb.github.io/css/pallete.css rel=stylesheet><link href=https://nnnewb.github.io/css/suCSS.css rel=stylesheet><link href=https://nnnewb.github.io/archive.css rel=stylesheet><link href=https://nnnewb.github.io/style.css rel=stylesheet><script defer src=https://nnnewb.github.io/js/script.js></script><link crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css integrity=sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y rel=stylesheet><script crossorigin defer integrity=sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx src=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js></script><script crossorigin defer integrity=sha384-zWYbd0NBwgTsgIdFKVprSfTh1mbMPe5Hz1X3yY4Sd1h/K1cQoUe36OGwAGz/PcDy src=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/mathtex-script-type.min.js></script><script crossorigin defer integrity=sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe src=https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js></script><script>document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
            // customised options
            // • auto-render specific keys, e.g.:
            delimiters: [
                { left: '$$', right: '$$', display: true },
                { left: '$', right: '$', display: false },
                { left: '\\(', right: '\\)', display: false },
                { left: '\\[', right: '\\]', display: false }
            ],
            // • rendering keys, e.g.:
            throwOnError: true
        });
    });</script><script src=https://cdn.jsdelivr.net/npm/mermaid@11.6.0/dist/mermaid.min.js></script><script>document.addEventListener('DOMContentLoaded', function () {
        // 查找所有具有 'pre' 标签且类名为 'language-mermaid' 的元素
        const mermaidElements = document.getElementsByClassName('language-mermaid');
        for (let i = 0; i < mermaidElements.length; i++) {
            const el = mermaidElements.item(i);
            if (el.tagName === "PRE" && !el.classList.contains('mermaid')) {
                el.innerHTML = el.textContent;
                el.classList.add('mermaid');
            }
        }

        mermaid.initialize({ startOnLoad: true, theme: 'dark', });
    })</script><script>if (window.location.hostname.toLowerCase() !== 'localhost' && window.location.hostname !== '127.0.0.1') {
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?dbb9df33a2de52aede8bccd84a7493ad";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    }</script><link href=https://chinese-fonts-cdn.deno.dev/packages/lxgwwenkaibright/dist/LXGWBright-Medium/result.css rel=stylesheet><link href=https://chinese-fonts-cdn.deno.dev/packages/maple-mono-cn/dist/MapleMono-CN-Regular/result.css rel=stylesheet><body><header><nav id=nav-bar><a href=/> 首页 </a>  /  <a href=/posts/> 文章 </a>  /  <a href=/categories/> 分类 </a>  /  <a href=/tags/> 标签 </a>  /  <a href=/search/> 搜索 </a>  /  <div><input id=theme-toggle style=display:none type=checkbox><label for=theme-toggle id=theme-toggle-label><svg class=icons id=theme-icon><use href=https://nnnewb.github.io/icons.svg#lightMode></use></svg></label><audio id=theme-sound><source src=https://nnnewb.github.io/click.ogg type=audio/ogg></audio></div></nav></header><main><h1>Windows 11 24H2 关闭 Hyper-V 和基于虚拟化的安全特性</h1><p class=author-line>作于：2025-01-15 00:00 ，预计阅读时间 4 分钟<article><h2 id=wen-ti-miao-shu>问题描述</h2><p><img alt="msinfo32 before turn off VBS/Hyper-V" src=https://nnnewb.github.io/posts/2025/2025-01-15-windows11-24h2guan-bi-hyperv/./images/msinfo32-before-turn-off.webp><p>目前网络上教你关闭 Hyper-V 的方法（也是我以前用的方法）是在控制面板的开启或关闭Windows特性里反选Hyper-V和虚拟机管理平台。<p>具体的操作方法有的是让你图形界面操作，有的是用 powershell 命令，下面的命令对应反选整个 Hyper-V 。<pre class=language-powershell data-lang=powershell style=color:#fdf4c1aa;background-color:#282828><code class=language-powershell data-lang=powershell><span style=color:#fabd2f>Disable-WindowsOptionalFeature </span><span style=color:#fe8019>-</span><span>Online </span><span style=color:#fe8019>-</span><span>FeatureName Microsoft</span><span style=color:#fe8019>-</span><span>Hyper</span><span style=color:#fe8019>-</span><span>V</span><span style=color:#fe8019>-</span><span>All
</span></code></pre><p>也有的给的是下面的命令，对应的就是仅反选 Hyper-V 平台的 Hypervisor 虚拟机服务。<pre class=language-powershell data-lang=powershell style=color:#fdf4c1aa;background-color:#282828><code class=language-powershell data-lang=powershell><span style=color:#fabd2f>Disable-WindowsOptionalFeature </span><span style=color:#fe8019>-</span><span>Online </span><span style=color:#fe8019>-</span><span>FeatureName Microsoft</span><span style=color:#fe8019>-</span><span>Hyper</span><span style=color:#fe8019>-</span><span>V</span><span style=color:#fe8019>-</span><span>Hypervisor
</span></code></pre><p>还有用 dism 的。<pre class=language-cmd data-lang=cmd style=color:#fdf4c1aa;background-color:#282828><code class=language-cmd data-lang=cmd><span>dism /online /disable-feature /featurename:microsoft-hyper-v-all
</span></code></pre><p>虽然花样百出但是 Windows 11 24H2 上没用。<p>今天在翻 MS Learn 的时候注意到，在关闭 Hyper-V 的文章里提到，想要运行其他 Hypervisor 的话要同时关闭 <em>Credential Guard</em> 和 <em>Device Guard</em>，对应的是 <code>msinfo32</code> 打开的系统信息窗口里看到的基于虚拟化的安全特性（图中 <em>Virtualization-based security</em>）<p>所以这篇博客记录的就是怎么干掉这个 VBS 。注意这会降低 Windows 的安全性，除非知道自己在做什么否则请不要操作。执行文中操作产生的一切后果自负。<h2 id=cao-zuo-liu-cheng>操作流程</h2><h3 id=1-zheng-chang-guan-bi-hyper-v-gong-neng>1. 正常关闭 Hyper-V 功能。</h3><p>到 <em>控制面板 > 程序 > 程序和功能 > 启用或关闭Windows功能</em> 下，反选：<ul><li>Hyper-V<li>虚拟机平台</ul><p><img alt=turn-off-hyper-v src=https://nnnewb.github.io/posts/2025/2025-01-15-windows11-24h2guan-bi-hyperv/./images/turn-off-hyper-v.webp><h3 id=2-guan-bi-device-guard>2. 关闭 Device Guard</h3><p>打开组策略编辑器 <code>gpedit.msc</code>，找到 <em>本地计算机策略>计算机配置>管理模板>系统>Device Guard</em> 。<p>在右侧选单编辑 <em>打开基于虚拟化的安全</em> ，选择禁用。<p><img alt=turn-off-device-guard src=https://nnnewb.github.io/posts/2025/2025-01-15-windows11-24h2guan-bi-hyperv/./images/turn-off-device-guard.webp><h3 id=3-guan-bi-credential-guard>3. 关闭 Credential Guard</h3><p>这里要借助一个微软的脚本，<a href="https://www.microsoft.com/en-us/download/details.aspx?id=53337&msockid=3353bc8848b26c971100a9b5490b6dde">下载地址</a>在这里。<p>下载解压得到 <code>DG_Readiness_Tool_v3.6.ps1</code> 这个脚本和一堆文件。<blockquote><p>对我知道这种鬼玩意儿很烦，我懒得看脚本内容去分析到底哪些步骤起作用了。<p>而且这个链接还可能说死就死。幸好不算大所以我<a href=https://nnnewb.github.io/posts/2025/2025-01-15-windows11-24h2guan-bi-hyperv/./asset/dgreadiness_v3.6.zip>留了一份</a>在博客上。</blockquote><p>在解压后的文件夹里以管理员权限运行 powershell 执行下面的命令。<pre class=language-powershell data-lang=powershell style=color:#fdf4c1aa;background-color:#282828><code class=language-powershell data-lang=powershell><span>.\DG_Readiness_Tool_v3.</span><span style=color:#d3869b>6.</span><span>ps1 </span><span style=color:#fe8019>-</span><span>Disable
</span></code></pre><p>可能会飘个红报错，自己到 <code>C:\DGLogs\DeviceGuardCheckLog.txt</code> 看日志，一般是 <code>del</code> 找不到文件，无视。<h3 id=4-zhong-qi>4. 重启</h3><blockquote><p>注意快速启动可能有影响，自己找怎么关快速启动。</blockquote><p>重启后会在引导的时候问是否关闭 <em>Device Guard</em> 和 <em>Credential Guard</em>，按 F3 或者 Win 键确定，ESC 跳过。<p>这里都确定关闭。开机后回到 Windows 桌面，再打开 <code>msinfo32</code> 就会看到生效了。<p><img alt=after-turn-off-vbs src=https://nnnewb.github.io/posts/2025/2025-01-15-windows11-24h2guan-bi-hyperv/./images/after-turn-off-vbs.webp></article><hr><blockquote class=reference-links><strong>参考链接</strong><ul><li><a href="https://www.reddit.com/r/Amd/comments/1fums7b/comment/lycwbc2/?utm_source=share&utm_medium=web3x&utm_name=web3xcss&utm_term=1&utm_content=share_button&rdt=52959">PSA: Disabling Memory Integrity in Windows 11 24H2 does not disable VBS. | reddit</a><li><a href="https://learn.microsoft.com/en-us/windows/security/identity-protection/credential-guard/configure?tabs=gpo">Configure Credential Guard | Microsoft Learn</a></ul></blockquote><p class=tags-data><a href=/tags/windows>/Windows/</a> <a href=/tags/hyper-v>/Hyper-V/</a></p><script data-repo-id="MDEwOlJlcG9zaXRvcnkzOTg0ODYyMTg=" async crossorigin data-category=Announcements data-category-id=DIC_kwDOF8Bqys4Cegmn data-emit-metadata=0 data-input-position=bottom data-lang=zh-CN data-mapping=pathname data-reactions-enabled=1 data-repo=nnnewb/nnnewb.github.io data-strict=0 data-theme=noborder_light id=giscus_script src=https://giscus.app/client.js></script></main><footer><hr><div id=footer-container><div><p style=text-align:center>Copyright © 2018-2024 weakptr <a href=mailto:weak_ptr@outlook.com>&lt;weak_ptr@outlook.com></a><p style=text-align:center>Built with <a rel="noopener noreferrer" href=https://www.getzola.org target=_blank>Zola</a> using <a rel="noopener noreferrer" href=https://github.com/Speyll/anemone target=_blank>anemone</a> theme, <a rel="noopener noreferrer" href=https://speyll.github.io/suCSS/ target=_blank>suCSS</a> framework & <a rel="noopener noreferrer" href=https://github.com/Speyll/veqev target=_blank>veqev</a>, modified by <a rel="noopener noreferrer" href=https://github.com/nnnewb/ target=_blank>nnnewb</a>.<p style=text-align:center>Theme and color theme licensed under <a rel="noopener noreferrer" href=https://en.wikipedia.org/wiki/Licence_MIT target=_blank>MIT</a>.</div></div></footer>